# zmodload zsh/zprof
autoload run-help
HELPDIR=$PREFIX/share/zsh/help

fpath+=${ZDOTDIR:-~}/.zsh_functions
ZSH_AUTOSUGGEST_HIGHLIGHT_STYLE='fg=10'
ZSH_AUTOSUGGEST_USE_ASYNC="true"

source $DOTFILES/zsh/private.zsh
source $HOME/antigen.zsh
antigen init $HOME/.antigenrc

# Stop stupid oh-my-zsh from breaking ls colors
alias ls='ls -FG --color=auto'
zstyle ':completion:*:default' list-colors ${(s.:.)LS_COLORS}

function shorten_pwd() {
  export SHORT_PWD="$($DOTFILES/bin/cwd.py $PWD)"
}

chpwd_functions=(${chpwd_functions[@]} "shorten_pwd")

function tmux_window_pwd() {
  tmux rename-window "$SHORT_PWD"
}
precmd_functions=(${precmd_functions[@]} "tmux_window_pwd")

[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh

source ~/.dotfiles/zsh/shell_prompt.zsh

test -e "${HOME}/.iterm2_shell_integration.zsh" && source "${HOME}/.iterm2_shell_integration.zsh"
test -e "${HOME}/.config/op/plugins.sh" && source "${HOME}/.config/op/plugins.sh"

setopt extendedglob
# zprof
